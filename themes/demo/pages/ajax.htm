title = "Ajax"
url = "/ajax"
is_hidden = 0
==
<?
use Illuminate\Support\Facades\DB;

function onStart()
{
   $table = $_GET['tb'];
   $length = $_GET['length'];
   $start = $_GET['start'];
   $fields = explode("|", $_GET['fd']);

   $result = DB::table($table)->skip($start)->limit($length)->get();
   $data = array();

   foreach($result as $row) {
      $sub_array = array();

      for ($i = 0; $i < count($fields); $i++) {

       //echo "<script>console.log('".gettype($fields[$i])."')</script>";
       if (strpos($fields[$i], 'time')) {
         $sub_array[] = gmdate("Y-m-d", $row->{$fields[$i]});
       } else {
          $sub_array[] = $row->{$fields[$i]};
       }


      }
      $data[] = $sub_array;
   }

   $output = array(
     "draw" => intval($_GET['draw']),
     "recordsTotal" => DB::table($table)->count(),
     "recordsFiltered" => DB::table($table)->count(),
     "data" => $data,
   );

   echo json_encode($output);
}

?>
==
